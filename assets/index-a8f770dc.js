import{T as f,g as w}from"./index-8e637133.js";import{x as l,c as k,d as o,e as x,t as u,n as h,b as O,h as j,i as L}from"./vendor-a218ddb8.js";import{u as $,w as D}from"./index-fa8e6f20.js";const P="/assets/doid-15c8a698.svg";var I=Object.defineProperty,M=Object.getOwnPropertyDescriptor,v=(t,i,n,s)=>{for(var e=s>1?void 0:s?M(i,n):i,r=t.length-1,a;r>=0;r--)(a=t[r])&&(e=(s?a(i,n,e):a(e))||e);return s&&e&&I(i,n,e),e};let y=class extends f(""){constructor(){super(...arguments),this.icon="",this.sm=!1,this.dense=!1}render(){return l`<strong href="/" class="block m-12 mx-auto ${k(this.$c([this.sm?"w-14 h-14 ":"w-24 h-24"]))}"><img class="w-full h-full object-contain select-none pointer-events-none" src="${this.icon||P}"></strong><div class="my-8 text-center"><strong class="block"><slot name="h1"></slot></strong><slot name="msg"></slot></div>`}};v([o()],y.prototype,"icon",2);v([o({type:Boolean})],y.prototype,"sm",2);v([o({type:Boolean})],y.prototype,"dense",2);y=v([x("doid-symbol")],y);let B=class extends f(""){constructor(){super(...arguments),this.sm=!1}render(){return l`<img class="w-full h-full object-contain select-none pointer-events-none ${k({"w-2/3 h-2/3":this.sm})}" src="${P}">`}};v([o({type:Boolean})],B.prototype,"sm",2);B=v([x("doid-icon")],B);var H=Object.defineProperty,T=Object.getOwnPropertyDescriptor,_=(t,i,n,s)=>{for(var e=s>1?void 0:s?T(i,n):i,r=t.length-1,a;r>=0;r--)(a=t[r])&&(e=(s?a(i,n,e):a(e))||e);return s&&e&&H(i,n,e),e};let S=class extends f(""){constructor(){super(...arguments),this.type="inline"}render(){switch(this.type){case"block":return l`<div class="block mx-auto my-8 text-center text-xl"><i class="mdi mdi-loading mx-1"></i></div>`;default:return l`<i class="mdi mdi-loading mr-1"></i> Loading...`}}};_([o({type:String})],S.prototype,"type",2);S=_([x("loading-icon")],S);const z=`.dui-input-text{position:relative;margin-left:auto;margin-right:auto;display:flex;width:100%;padding-top:1.25rem;padding-bottom:1.25rem}.dui-input-text input[type]{font-family:var(--fontFamily);position:relative;display:inline-flex;height:2rem;width:100%;border-radius:.375rem;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));padding:1.25rem .75rem;font-size:.875rem;line-height:1.25rem}@media (min-width: 640px){.dui-input-text input[type]{padding:1.5rem;font-size:1rem;line-height:1.5rem}}.dui-input-text input[type]{border:1px solid #ccc}.dui-input-text[disabled]{opacity:.6}.dui-input-text.dense,.dui-input-text.sm{padding-top:0;padding-bottom:0}.dui-input-text.sm input[type]{height:1.25rem;padding-top:1rem;padding-bottom:1rem;font-size:.875rem;line-height:1.25rem}@media (min-width: 640px){.dui-input-text.sm input[type]{height:1.5rem}}.dui-input-text.sm .dui-input-right,.dui-input-text.sm .dui-input-left{padding-top:1rem;padding-bottom:1rem;line-height:1rem}.dui-input-text .dui-input-msg,.dui-input-text .dui-input-tip,.dui-input-text label{line-height:1!important}.dui-input-text .dui-input-msg,.dui-input-text .dui-input-tip,.dui-input-text label{position:absolute;display:flex;height:1rem;flex-wrap:wrap;align-items:center;padding-left:.75rem;padding-right:.75rem;font-size:.875rem;line-height:1.25rem;margin-left:1px;top:.15rem}.dui-input-text .dui-input-msg{top:auto;bottom:.15rem}.dui-input-text .dui-input-tip{left:auto;right:0}.dui-input-text .dui-input-right,.dui-input-text .dui-input-left{pointer-events:none;position:absolute;display:flex;height:1.25rem;align-items:center;justify-content:center;border-top-right-radius:.375rem;border-bottom-right-radius:.375rem;padding:1.25rem .25rem 1.25rem .5rem}@media (min-width: 640px){.dui-input-text .dui-input-right,.dui-input-text .dui-input-left{height:1.5rem;padding:1.5rem .5rem 1.5rem 1.5rem}}.dui-input-text .dui-input-right,.dui-input-text .dui-input-left{min-width:1.5rem;z-index:1;right:1px;margin-top:1px;font-size:1em;line-height:1em}.dui-input-text .dui-input-right:empty,.dui-input-text .dui-input-left:empty{--tw-bg-opacity: 1;background-color:#000;background-color:rgba(0,0,0,var(--tw-bg-opacity))}.dui-input-text .dui-input-right>*,.dui-input-text .dui-input-left>*{pointer-events:auto}.dui-input-text .dui-input-left{right:auto;left:1px}.dui-input-text[required] label:after{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;font-weight:600;line-height:1;--tw-text-opacity: 1;color:#ef4444;color:rgba(239,68,68,var(--tw-text-opacity));content:"*";height:1em;margin-left:.25em}.dui-input-text[rightSlotted] input[type]{padding-right:5rem}.dui-input-text.sm[rightSlotted] input[type]{padding-right:2.5rem}.dui-input-text[leftSlotted] input[type]{padding-left:2.75rem}.dui-input-text.sm[leftSlotted] input[type]{padding-left:2rem}
`;var q=Object.defineProperty,N=Object.getOwnPropertyDescriptor,d=(t,i,n,s)=>{for(var e=s>1?void 0:s?N(i,n):i,r=t.length-1,a;r>=0;r--)(a=t[r])&&(e=(s?a(i,n,e):a(e))||e);return s&&e&&q(i,n,e),e};const C=(t,i,{lower:n=!1,upper:s=!1}={})=>(t&&(t=t==null?void 0:t.trim(),n?t=t.toLowerCase():s&&(t=t.toUpperCase())),t);let p=class extends f(z){constructor(){super(...arguments),this.placeholder="",this.class="",this.sm=!1,this.dense=!1,this.disabled=!1,this.autofocus=!1,this.required=!1,this.lower=!1,this.upper=!1,this.err=!1,this.value="",this.debounce=300,this.rightSlotted=!1,this.leftSlotted=!1,this.type="text",this.onKeyup=t=>{t.key==="Enter"&&(this.emit("submit",this.value),setTimeout(()=>this.updateVal()))}}onSlotChange(t){const i=t.target;if(!i)return;i.assignedNodes({flatten:!0}).length}onSlotRight(t){this.rightSlotted=!!t.target}onSlotLeft(t){this.leftSlotted=!!t.target}firstUpdated(){this.autofocus&&this.$("input").focus()}onFocus(t){t.target.select()}updateVal(){const t=this.$("input");t&&(t.value=this.value)}onInput(t){t.stopImmediatePropagation();let i=t.target.value.trim();this.value=C(i,null,{lower:this.lower,upper:this.upper})||"",this.updateVal(),this.emit("input",i)}render(){return l`<div class="dui-input-text ${k(this.$c([this.class,{sm:this.sm,dense:this.dense}]))}" ?required="${this.required}" ?rightSlotted="${this.rightSlotted}" ?leftSlotted="${this.leftSlotted}" part="dui-input-text"><label><slot name="label" @slotchange="${this.onSlotChange}"></slot></label> <span class="dui-input-left"><slot name="left" @slotchange="${this.onSlotLeft}"></slot></span><input .type="${this.type}" .disabled="${this.disabled}" placeholder="${this.placeholder}" value="${this.value}" title="${this.title}" @focus="${this.onFocus}" @input="${this.onInput}" @keyup="${this.onKeyup}"><div class="dui-input-right"><slot name="right" @slotchange="${this.onSlotRight}"></slot></div><div class="dui-input-msg"><slot name="msg" @slotchange="${this.onSlotChange}"></slot></div><div class="dui-input-tip"><slot name="tip" @slotchange="${this.onSlotChange}"></slot></div></div>`}};d([o({type:String})],p.prototype,"placeholder",2);d([o({type:String})],p.prototype,"class",2);d([o({type:Boolean})],p.prototype,"sm",2);d([o({type:Boolean})],p.prototype,"dense",2);d([o({type:Boolean})],p.prototype,"disabled",2);d([o({type:Boolean})],p.prototype,"autofocus",2);d([o({type:Boolean})],p.prototype,"required",2);d([o({type:Boolean})],p.prototype,"lower",2);d([o({type:Boolean})],p.prototype,"upper",2);d([o({type:Boolean})],p.prototype,"err",2);d([o({type:String,converter:C})],p.prototype,"value",2);d([o({type:Number})],p.prototype,"debounce",2);d([u()],p.prototype,"rightSlotted",2);d([u()],p.prototype,"leftSlotted",2);d([u()],p.prototype,"type",2);p=d([x("dui-input-text")],p);const F="";var R=Object.defineProperty,V=Object.getOwnPropertyDescriptor,m=(t,i,n,s)=>{for(var e=s>1?void 0:s?V(i,n):i,r=t.length-1,a;r>=0;r--)(a=t[r])&&(e=(s?a(i,n,e):a(e))||e);return s&&e&&R(i,n,e),e};let c=class extends f(F){constructor(){super(...arguments),this.placeholder="Search names or addresses",this.entire=!1,this.keyword="",this.err="",this.pending=!1,this.onInput=async t=>{this.keyword=t.detail}}doSearch(){this.err||this.emit("search",this.keyword)}async connectedCallback(){super.connectedCallback(),typeof this.default>"u"}render(){return l`<dui-input-text @input="${this.onInput}" @submit="${this.doSearch}" value="${this.keyword}" placeholder="${this.placeholder}" ?disabled="${this.pending}"><span slot="label"><slot name="label"></slot></span><span slot="right" class="-mr-1"><dui-button @click="${this.doSearch}" icon sm class="text-blue-500"><i class="mdi mdi-magnify text-lg"></i></dui-button></span><span slot="msg">${h(this.err,()=>l`<span class="text-red-500">${this.err}</span>`,()=>l`<slot name="msg"></slot>`)}</span></dui-input-text>`}};m([o()],c.prototype,"placeholder",2);m([o()],c.prototype,"default",2);m([o({type:Boolean})],c.prototype,"entire",2);m([u()],c.prototype,"keyword",2);m([u()],c.prototype,"err",2);m([u()],c.prototype,"pending",2);c=m([x("dui-block-search")],c);const Y=`.incoming{transform-origin:top;animation:incoming .4s ease-out}@keyframes incoming{0%{margin-top:0;margin-bottom:0;height:0px;--tw-translate-y: 0px;transform:translate(var(--tw-translate-x)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));padding-top:0;padding-bottom:0}}
`;var K=Object.defineProperty,E=Object.getOwnPropertyDescriptor,b=(t,i,n,s)=>{for(var e=s>1?void 0:s?E(i,n):i,r=t.length-1,a;r>=0;r--)(a=t[r])&&(e=(s?a(i,n,e):a(e))||e);return s&&e&&K(i,n,e),e};let g=class extends f(Y){constructor(){super(...arguments),this.bindBlocks=new O(this,$),this.miner="",this.minerData={data:[],totalPage:0,page:1,limit:10,ts:0},this.minerBlocks=[],this.pending=!1,this.goto=t=>{w(`/block/${t.height}`)},this.getMinerBlocks=(t=1)=>{this.miner&&(this.pending=!0,t<1&&(t=1),this.minerData.totalPage!=0&&t>=this.minerData.totalPage&&(t=this.minerData.totalPage),this.minerData.page=t,this.minerBlocks=[],this.minerData.ts=0,D({method:"doid_getBlockByMiner",params:[{miner:this.miner.toLowerCase(),limit:this.minerData.limit,page:this.minerData.page}]},({data:i,totalPage:n}={})=>{this.minerData.data=i,this.minerData.totalPage=n;for(let s in this.minerData.data)D({method:"doid_getBlockByHeight",params:[this.minerData.data[s]]},({header:e}={})=>{t===this.minerData.page&&(this.minerBlocks=[e,...this.minerBlocks].sort((r,a)=>r.height-a.height),this.pending=!1,this.minerData.ts++)});this.minerBlocks.length=Math.min(this.minerBlocks.length,this.minerData.limit)}))}}get loading(){return this.miner?!this.minerData.ts:$.loading}search(t){(t.detail.toString().length==64?"tx":"block")=="tx"?w(`/tx/${t.detail}`):w(`/block/${t.detail}`)}connectedCallback(){super.connectedCallback(),this.getMinerBlocks()}render(){return l`<div class="home"><div class="dui-container"><div class="mx-auto">${h(this.miner,()=>null,()=>l`<div class="max-w-full mx-auto"><dui-block-search @search="${this.search}" placeholder="Search Txn Hash / Block Height"></dui-block-search></div>`)}</div><div class="mt-4 flex justify-between items-center px-1"><div class="text-3xl">${h(!this.miner,()=>"Latest Blocks",()=>l`<div class="text-blue-700 font-bold cursor-pointer uppercase text-sm" @click="${()=>w("/")}"><i class="mdi mdi-arrow-left"></i> Back</div><div class="mt-1">Blocks</div>`)}</div><div>${h(!this.miner,()=>l`${h($.isConnected,()=>l`<div class="inline-flex gap-2 items-center text-green-600"><span class="relative inline-flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-600 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-green-700"></span> </span>Connected</div>`,()=>l`<div class="text-gray-600 inline-block"><i class="mdi mdi-lan-disconnect mx-1"></i>Connecting...</div>`)}`,()=>l`<div class="text-sm mt-1 text-gray-400">By: <i class="mdi mdi-laptop mx-1"></i>${this.miner}</div>`)}</div></div><div class="mt-2 blocks-table"><div class="flex block-header uppercase py-2 border-y"><div class="flex-none w-20 p-2">BLOCK</div><div class="flex-1 p-2">timestamp</div><div class="flex-1 p-2">HASH</div><div class="flex-1 p-2 text-right">miner</div><div class="flex-1 p-2 text-right">transactionsRoot</div></div>${h(!this.loading,()=>l`${j(this.miner?this.minerBlocks:$.blocks,t=>L(t.height,l`<div class="flex overflow-hidden bg-gray-100 rounded-lg mt-2 cursor-pointer h-14 items-center py-2 hover_bg-gray-300 ${k({incoming:!!t.incoming})}" @click="${()=>this.goto(t)}"><div class="flex-none w-20 p-2 text-blue-500 underline">${t.height}</div><div class="flex-1 p-2 truncate">${new Date(t.timestamp*1e3).toLocaleString()}</div><div class="flex-1 p-2 truncate">${t.parentHash}</div><div class="flex-1 p-2 text-right truncate">${t.miner}</div><div class="flex-1 p-2 text-right truncate">${t.transactionsRoot}</div></div>`))}`,()=>l`<div class="text-center p-3 border-t-2"><loading-icon type="inline-block"></loading-icon></div>`)} ${h(this.miner&&this.minerData.totalPage,()=>l`<div class="flex justify-center items-center my-4"><dui-button title="First Page" icon class="text-blue-500" @click="${()=>this.getMinerBlocks(1)}"><i class="mdi mdi-page-first text-lg"></i></dui-button><dui-button title="Previous Page" icon class="text-blue-500" @click="${()=>this.getMinerBlocks(this.minerData.page-1)}"><i class="mdi mdi-chevron-left text-lg"></i></dui-button><div class="text-gray-300 text-sm inline-block mx-1">Page ${this.minerData.page} of ${this.minerData.totalPage}</div><dui-button title="Next Page" icon class="text-blue-500" @click="${()=>this.getMinerBlocks(this.minerData.page+1)}"><i class="mdi mdi-chevron-right text-lg"></i></dui-button><dui-button title="Last Page" icon class="text-blue-500" @click="${()=>this.getMinerBlocks(this.minerData.totalPage)}"><i class="mdi mdi-page-last text-lg"></i></dui-button></div>`)}</div></div></div>`}};b([o()],g.prototype,"miner",2);b([u()],g.prototype,"minerData",2);b([u()],g.prototype,"minerBlocks",2);b([u()],g.prototype,"pending",2);g=b([x("view-home")],g);export{g as ViewHome};
